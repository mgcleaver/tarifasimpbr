% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ler_anexo.R
\name{formata_datas}
\alias{formata_datas}
\title{Formatar datas provenientes dos anexos de tarifas}
\usage{
formata_datas(x, preenche_data = NULL)
}
\arguments{
\item{x}{Vetor de caracteres contendo datas em diferentes formatos:
\itemize{
\item numeros inteiros representando datas no padrao Excel
(serial date);
\item datas textuais (ex.: \code{"01/02/2024"}, \code{"2024-02-01"});
\item hifen (\code{"-"}), indicando ausencia de data.
}}

\item{preenche_data}{Valor opcional usado para substituir entradas iguais
a \code{"-"}. Se \code{NULL} (padrao), o hifen e convertido para \code{NA}.
Caso contrario, o hifen e substituido pelo valor informado antes da
tentativa de conversao (por exemplo: \code{"9999-12-31"}).}
}
\value{
Um vetor de classe \code{Date} com as datas convertidas. Entradas invalidas
ou impossiveis de interpretar retornam \code{NA}.
}
\description{
Funcao auxiliar para padronizar datas que podem vir em formatos
heterogeneos nos anexos de tarifas: datas escritas como texto,
datas no formato numerico do Excel (serial number) ou valores
especiais representados por hifen (\code{"-"}).
}
\details{
Esta funcao e usada internamente por \code{ler_anexo} e
outras funcoes de limpeza dos anexos.

A funcao segue tres passos principais:
\itemize{
\item remocao de espacos em branco nas extremidades;
\item substituicao opcional do hifen (\code{"-"}) pelo valor definido
em \code{preenche_data};
\item identificacao e conversao de datas em formato Excel (numeros
inteiros) e de datas textuais, usando
\code{lubridate::parse_date_time} com multiplas ordens possiveis
(\code{"dmy"}, \code{"dmY"}, \code{"ymd"}, \code{"Ymd"}).
}

Notas:
\itemize{
\item A origem do Excel usada e \code{"1899-12-30"}, compativel com o
comportamento padrao do Excel no Windows.
\item Conflitos de parsing sao suprimidos com \code{suppressWarnings()}.
}
}
\examples{
\dontrun{
formata_datas(c("01/02/2024", "2024-02-01"))
formata_datas(c("45210", "45211"))  # datas em formato Excel
formata_datas(c("-", "01/01/2024"), preenche_data = "9999-12-31")
}

}
\keyword{internal}
