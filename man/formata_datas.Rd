% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ler_anexo.R
\name{formata_datas}
\alias{formata_datas}
\title{Formatar datas provenientes dos anexos de tarifas}
\usage{
formata_datas(x, preenche_data = NULL)
}
\arguments{
\item{x}{Vetor de caracteres contendo datas em diferentes formatos:
\itemize{
\item números inteiros representando datas no padrão Excel
(serial date);
\item datas textuais (ex.: \code{"01/02/2024"}, \code{"2024-02-01"});
\item hífen (\code{"-"}), indicando ausência de data.
}}

\item{preenche_data}{Valor opcional usado para substituir entradas iguais
a \code{"-"}. Se \code{NULL} (padrão), o hífen é convertido para \code{NA}.
Caso contrário, o hífen é substituído pelo valor informado antes da
tentativa de conversão (por exemplo: \code{"9999-12-31"}).}
}
\value{
Um vetor de classe \code{Date} com as datas convertidas. Entradas inválidas
ou impossíveis de interpretar retornam \code{NA}.
}
\description{
Função auxiliar para padronizar datas que podem vir em formatos
heterogêneos nos anexos de tarifas: datas escritas como texto,
datas no formato numérico do Excel (serial number) ou valores
especiais representados por hífen (\code{"-"}).
}
\details{
Esta função é usada internamente por \code{ler_anexo} e
outras funções de limpeza dos anexos.

A função segue três passos principais:
\itemize{
\item remoção de espaços em branco nas extremidades;
\item substituição opcional do hífen (\code{"-"}) pelo valor definido
em \code{preenche_data};
\item identificação e conversão de datas em formato Excel (números
inteiros) e de datas textuais, usando
\code{lubridate::parse_date_time} com múltiplas ordens possíveis
(\code{"dmy"}, \code{"dmY"}, \code{"ymd"}, \code{"Ymd"}).
}

Notas:
\itemize{
\item A origem do Excel usada é \code{"1899-12-30"}, compatível com o
comportamento padrão do Excel no Windows.
\item Conflitos de parsing são suprimidos com \code{suppressWarnings()}.
}
}
\examples{
\dontrun{
formata_datas(c("01/02/2024", "2024-02-01"))
formata_datas(c("45210", "45211"))  # datas em formato Excel
formata_datas(c("-", "01/01/2024"), preenche_data = "9999-12-31")
}

}
\keyword{internal}
